if(!nexacro.Tray){nexacro.Tray=function(_a,_b){this.id=_a;this.icon="default";this.tooltip="";this.items=new nexacro.Collection();this.name=_a;this._handle=null;this._init_flag=false;this._event_list={"onlbuttonup":1,"onrbuttonup":1,"ondblclick":1};};var _pTray=nexacro._createPrototype(nexacro.EventSinkObject,nexacro.Tray);nexacro.Tray.prototype=_pTray;_pTray._type_name="Tray";_pTray.on_created=function(){var _a=this.icon;if(_a&&_a.indexOf("::")> -1){_a=application._getServiceLocation(_a);}this._handle=nexacro._createTrayHandle(_a,this.tooltip);var _b=this.items.length;for(var _c=0;_c<_b;_c++ ){this.items[_c].on_created();}};_pTray._destroy=function(){var _a=this.items.length;for(var _b=_a-1;_b>=0;_b-- ){this.items.delete_item(_b);}nexacro._removeTrayHandle(this._handle);application.trays.delete_item(this.id);application.all.delete_item(this.id);};_pTray.set_id=function(_a){if(_a!=this.id){this.id=this.name=_a;}};_pTray.set_name=function(_a){if(_a!=this.name){this.id=this.name=_a;}};_pTray.set_icon=function(_a){if(_a!=this.icon){this.icon=_a;}if(this._handle){nexacro._setTrayIconHandle(this._handle,this.icon);}};_pTray.set_tooltip=function(_a){if(_a!=this.tooltip){this.tooltip=_a;}if(this._handle){nexacro._setTrayTooltipHandle(this._handle,this.tooltip);}};_pTray.show=function(){if(this._init_flag){this.on_created();}};_pTray.destroy=function(){this._destroy();};_pTray.init=function(_a,_b,_c){var _d=application.trays[_a];if(_d&&_d._handle==null){this.set_id(_a);this.set_icon(_b);this.set_tooltip(_c);this._init_flag=true;}};_pTray.showBalloonTip=function(_a,_b,_c,_d){var _e=false;var _f= -1;if(!_d){_d=false;}nexacro._showTrayBalloonTipHandle(this._handle,_a,_b,_c,_f,_d);};_pTray.addItem=function(_a,_b){if(_b._type_name=="TrayPopupMenu"){if(this.items.indexOf(_a)>=0){return  -1;}else{return this.items.add_item(_a,_b);}}};_pTray.insertItem=function(_a,_b,_c){if(_c._type_name=="TrayPopupMenu"){if(this.items.indexOf(_b)>=0){return  -1;}else{return this.items.insert_item(_a,_b,_c);}}};_pTray.deleteItem=function(_a){return this.items.delete_item(_a);};_pTray.findItem=function(_a){var _b=this.items.indexOf(_a);if(_b==undefined){_b= -1;}return _b;};_pTray.getItemCount=function(){var _a=this.items.size();return _a;};_pTray.destroy=function(){this._destroy();};_pTray.on_fire_ondblclick=function(_a,_b,_c,_d,_e,_f){if(this.ondblclick&&this.ondblclick._has_handlers){var _g=new nexacro.ClickEventInfo(this,"ondblclick","lbutton",_b,_c,_d,_e,_f, -1, -1, -1, -1,this,this);return this.ondblclick._fireEvent(this,_g);}return false;};_pTray.on_fire_onlbuttonup=function(_a,_b,_c,_d,_e,_f){if(this.onlbuttonup&&this.onlbuttonup._has_handlers){var _g=new nexacro.MouseEventInfo(this,"onlbuttonup","lbutton",_b,_c,_d,_e,_f, -1, -1, -1, -1,this,this);return this.onlbuttonup._fireEvent(this,_g);}return false;};_pTray.on_fire_onrbuttonup=function(_a,_b,_c,_d,_e,_f){if(this.onrbuttonup&&this.onrbuttonup._has_handlers){var _g=new nexacro.MouseEventInfo(this,"onrbuttonup","rbutton",_b,_c,_d,_e,_f, -1, -1, -1, -1,this,this);return this.onrbuttonup._fireEvent(this,_g);}return false;};delete _pTray;};if(!nexacro.TrayPopupMenu){nexacro.TrayPopupMenu=function(_a,_b){this.id=_a;this.parent=_b;this._popupmenu=null;this._handle=null;this.innerdataset="";this._innerdataset="";this._level=0;this._rowindex=0;this.captioncolumn="";this.checkboxcolumn="";this.enablecolumn="";this.hotkeycolumn="";this.iconcolumn="";this.idcolumn="";this.levelcolumn="";this.userdatacolumn="";this._event_list={"onmenuclick":1};};var _pTrayPopupMenu=nexacro._createPrototype(nexacro.EventSinkObject,nexacro.TrayPopupMenu);nexacro.TrayPopupMenu.prototype=_pTrayPopupMenu;_pTrayPopupMenu._type_name="TrayPopupMenu";_pTrayPopupMenu.set_visible=nexacro._emptyFn;_pTrayPopupMenu.on_created=function(){if(this._innerdataset==null&&this.innerdataset!=null){var _a=this.innerdataset;this._innerdataset=application._getDatasetObject(_a);this.on_apply_innerdataset();}this._handle=nexacro._createTrayPopupMenuHandle(this.parent._handle);this._createPopupMenu(this._handle);};_pTrayPopupMenu._createPopupMenu=function(_a){var _b=this._innerdataset;if(_b&&this.levelcolumn&&this.captioncolumn&&this.idcolumn){var _c=_b.getRowCount();for(var _n=this._rowindex;_n<_c;_n++ ){var _d=_b.getColumn(_n,this.levelcolumn);if(_d==this._level){var _e="string";var _f=_b.getColumn(_n,this.captioncolumn);if(_f=="-"){_e="separator";}var _g=_b.getColumn(_n,this.iconcolumn);if(_g){_e="bitmap";}var _h=_b.getColumn(_n,this.enablecolumn);if(_h){if(!nexacro._toBoolean(_h)){_e="disabled";}}var _i=_b.getColumn(_n,this.idcolumn);if(_i){_i=_n;}var _j=_b.getColumn(_n,this.checkboxcolumn);if(_j){if(nexacro._toBoolean(_j)){_e="checked";}}var _k=_b.getColumn(_n,this.userdatacolumn);var _g=_b.getColumn(_n,this.iconcolumn);var _l=_b.getColumn(_n+1,this.levelcolumn);if(_l-_d==1){_e="popup";var _m=nexacro._createTrayPopupMenuHandle(this.parent._handle);this._level++ ;this._rowindex=_n+1;this._createPopupMenu(_m);nexacro._setTrayPopupMenuItemHandle(this.parent._handle,_a,_e,_m,_f,_g);this._level-- ;_l=_b.getColumn(this._rowindex+1,this.levelcolumn);if(_l-_d<0){break;}}else if(_l-_d<0){nexacro._setTrayPopupMenuItemHandle(this.parent._handle,_a,_e,_i,_f,_g);this._rowindex=_n;break;}else{nexacro._setTrayPopupMenuItemHandle(this.parent._handle,_a,_e,_i,_f,_g);}}}}};_pTrayPopupMenu._updatePopupMenu=function(_a){this._level=0;this._rowindex=0;nexacro._destroyTrayPopupMenuHandle(this.parent._handle,_a);this._handle=nexacro._createTrayPopupMenuHandle(this.parent._handle);this._createPopupMenu(this._handle);};_pTrayPopupMenu.trackPopup=function(){if(this._handle){nexacro._displayTrayPopupMenuHandle(this.parent._handle,this._handle);application._current_tray_popup=this;}};_pTrayPopupMenu.set_innerdataset=function(_a){if(typeof _a!="string"){this.setInnerDataset(_a);return;}if(_a!=this.innerdataset){if(!_a){this._innerdataset=null;this.innerdataset="";}else{_a=_a.replace("@","");this._innerdataset=application._getDatasetObject(_a);this.innerdataset=_a;}this.on_apply_innerdataset();}else if(this.innerdataset&&!this._innerdataset){this._setInnerDatasetStr(this.innerdataset);this.on_apply_innerdataset();}};_pTrayPopupMenu.on_apply_innerdataset=function(){var _a=this._innerdataset;if(_a){var _b=this._callbackFromDataset;_a._setEventHandler("onrowposchanged",_b,this);_a._setEventHandler("oncolumnchanged",_b,this);_a._setEventHandler("onrowsetchanged",_b,this);if(this._handle){this._updatePopupMenu(this._handle);}}};_pTrayPopupMenu._setInnerDatasetStr=function(_a){if(!_a){this._innerdataset=null;this.innerdataset="";}else{_a=_a.replace("@","");this._innerdataset=application._getDatasetObject(_a);this.innerdataset=_a;}};_pTrayPopupMenu.getInnerDataset=function(){return this._innerdataset;};_pTrayPopupMenu.setInnerDataset=function(_a){if(!_a){this._innerdataset=null;this.innerdataset="";this.on_apply_innerdataset();}else if(_a instanceof nexacro.Dataset){this._innerdataset=_a;this.innerdataset=_a.id;this.on_apply_innerdataset();}};_pTrayPopupMenu.set_captioncolumn=function(_a){if(_a!=this.captioncolumn){this.captioncolumn=_a;this.on_apply_captioncolumn();}};_pTrayPopupMenu.on_apply_captioncolumn=function(){var _a=this._innerdataset;if(_a){this._updatePopupMenu(this._handle);}};_pTrayPopupMenu.set_checkboxcolumn=function(_a){if(_a!=this.checkboxcolumn){this.checkboxcolumn=_a;this.on_apply_checkboxcolumn();}};_pTrayPopupMenu.on_apply_checkboxcolumn=function(){var _a=this._innerdataset;if(_a){this._updatePopupMenu(this._handle);}};_pTrayPopupMenu.set_enablecolumn=function(_a){if(_a!=this.enablecolumn){this.enablecolumn=_a;this.on_apply_enablecolumn();}};_pTrayPopupMenu.on_apply_enablecolumn=function(){var _a=this._innerdataset;if(_a){this._updatePopupMenu(this._handle);}};_pTrayPopupMenu.set_hotkeycolumn=function(_a){if(_a!=this.hotkeycolumn){this.hotkeycolumn=_a;this.on_apply_hotkeycolumn();}};_pTrayPopupMenu.on_apply_hotkeycolumn=function(){var _a=this._innerdataset;if(_a){this._updatePopupMenu(this._handle);}};_pTrayPopupMenu.set_iconcolumn=function(_a){if(_a!=this.iconcolumn){this.iconcolumn=_a;this.on_apply_iconcolumn();}};_pTrayPopupMenu.on_apply_iconcolumn=function(){var _a=this._innerdataset;if(_a){this._updatePopupMenu(this._handle);}};_pTrayPopupMenu.set_idcolumn=function(_a){if(_a!=this.idcolumn){this.idcolumn=_a;this.on_apply_idcolumn();}};_pTrayPopupMenu.on_apply_idcolumn=function(){var _a=this._innerdataset;if(_a){this._updatePopupMenu(this._handle);}};_pTrayPopupMenu.set_levelcolumn=function(_a){if(_a!=this.levelcolumn){this.levelcolumn=_a;this.on_apply_levelcolumn();}};_pTrayPopupMenu.on_apply_levelcolumn=function(){var _a=this._innerdataset;if(_a){this._updatePopupMenu(this._handle);}};_pTrayPopupMenu.set_userdatacolumn=function(_a){if(_a!=this.userdatacolumn){this.userdatacolumn=_a;this.on_apply_userdatacolumn();}};_pTrayPopupMenu.on_apply_userdatacolumn=function(){var _a=this._innerdataset;if(_a){this._updatePopupMenu(this._handle);}};_pTrayPopupMenu.on_fire_onmenuclick=function(_a){var _b=this._innerdataset;var _c=_a;var _d=_b.getColumn(_c,this.idcolumn);var _e=_b.getColumn(_c,this.userdatacolumn);var _f=_b.getColumn(_c,this.levelcolumn);if(this.onmenuclick&&this.onmenuclick._has_handlers){var _g=new nexacro.MenuClickEventInfo(this,"onmenuclick",_d,_e,_c,_f);this.onmenuclick._fireEvent(this,_g);}};delete _pTrayPopupMenu;};