if(!nexacro.ExcelExportObject){nexacro.ExcelExportProgressEventInfo=function(_a,_b,_c,_d,_e,_f){this.id=this.eventid=_b||"onprogress";this.fromobject=_a;this.fromreferenceobject=_f;this.itemindex=_c;this.itemtype=_d;this.recordindex=_e;};var _pExportEventInfo=nexacro._createPrototype(nexacro.Event,nexacro.ExcelExportProgressEventInfo);nexacro.ExcelExportProgressEventInfo.prototype=_pExportEventInfo;_pExportEventInfo._type_name="ExcelExportProgressEventInfo";delete _pExportEventInfo;nexacro.ExcelExportEventInfo=function(_a,_b,_c,_d){this.id=this.eventid=_b||"onsuccess";this.fromobject=_a;this.fromreferenceobject=_d;this.url=_c;};var _pExcelExportEventInfo=nexacro._createPrototype(nexacro.Event,nexacro.ExcelExportEventInfo);nexacro.ExcelExportEventInfo.prototype=_pExcelExportEventInfo;_pExcelExportEventInfo._type_name="ExcelExportEventInfo";delete _pExcelExportEventInfo;nexacro.ExcelExportErrorEventInfo=function(_a,_b,_c,_d,_e,_f){this.id=this.eventid=_b||"onerror";this.fromobject=_a;this.fromreferenceobject=_e;this.errortype=_c;this.errormsg=_d;this.statuscode=_f;};var _pExportErrorEventInfo=nexacro._createPrototype(nexacro.ErrorEventInfo,nexacro.ExcelExportErrorEventInfo);nexacro.ExcelExportErrorEventInfo.prototype=_pExportErrorEventInfo;_pExportErrorEventInfo._type_name="ExcelExportErrorEventInfo";delete _pExportErrorEventInfo;nexacro.ExcelExportObject=function(_a,_b){this.id=this.name=_a;if(!_b){_b=application.getActiveForm();if(!_b){var _c=application.popupframes;var _d=_c?_c.length:0;for(var _j=0;_j<_d;_j++ ){var _e=_c[_j]._window;if(_e){var _f=_e.getActiveFrame();if(_f&&_f.form instanceof nexacro.Form){_b=_f.form;break;}}}if(!_b){_e=application.mainframe._window;var _g=_e.getCurrentFocusPaths();var _h=(_g?_g.length:0);for(_j=0;_j<_h;_j++ ){var _i=_g[_j];if(!_i){continue;}if(_i._is_form){_b=_i;break;}}}}}this.parent=_b;this.activepagename="";this.exportactivemode="noactive";this.exporteventtype="itemrecord";this.exportfilename="";this.exportmessagealert="";this.exportmessagecomplete="";this.exportmessageprocess="";this.exportmessageready="";this.exportopenmode="noopen";this._exporttype=nexacro.ExportTypes.EXCEL;this.exporttype=nexacro.ExportTypes.EXCEL;this.exportuitype="none";this.templatefilename="";this.commdataformat="";this.commcompress="none";this.exporturl="";this.filedialogpath="";this.openedpath="";this.filefilter="";this.filefilterindex=0;this._exportuitype=0;this._exporturl="";this._commcompress=false;this._commdataformat=2;this._grids=[];this._dataset=[];this._xml=[];this._allRowCount=0;this._progress_pos=0;this._uniqueIndex=0;this._fileURL="";this._itemsIndex=0;this._argsParam=null;this._argsDsParam=null;this._is_orgval=false;this._file_password=null;this._wrap_text=true;this._exportBar;this._tempSaveMethod=null;this.onsuccess=new nexacro.EventListener("onsuccess");this.onprogress=new nexacro.EventListener("onprogress");this.onerror=new nexacro.EventListener("onerror");this._handle=null;nexacro._create_filedownload_handle(this.on_complete_download,this);this._event_list={"onsuccess":1,"onerror":1,"onprogress":1};};var _pExcelExport=nexacro.ExcelExportObject.prototype=nexacro._createPrototype(nexacro.EventSinkObject,nexacro.ExcelExportObject);_pExcelExport._type_name="ExportObject";_pExcelExport.excelTypeTable={EXCEL:0x0100,EXCEL97:0x0110,EXCEL2007:0x0120,HANCELL2010:0x0400,HANCELL2014:0x0410,CSV:0x0500,256:0x0100,272:0x0110,288:0x0120,1024:0x0400,1040:0x0410,1280:0x0500};_pExcelExport.on_created=nexacro._emptyFn;_pExcelExport.set_templatefilename=function(_a){if(_a!=this.templatefilename){this.templatefilename=_a;}return _a;};_pExcelExport.set_commdataformat=function(_a){if(_a!=this.commdataformat){this.commdataformat=_a;switch(_a.toString().toUpperCase()){case "XML":this._commdataformat=0;break;case "BINARY":this._commdataformat=1;break;default:this._commdataformat=2;break;}}return _a;};_pExcelExport.set_commcompress=function(_a){if(_a!=this.commcompress){this.commcompress=_a;switch(_a.toString().toUpperCase()){case "COMPRESS":this._commcompress=true;break;default:this._commcompress=false;break;}}return _a;};_pExcelExport.set_exporturl=function(_a){if(_a!=this.exporturl){this.exporturl=_a;this._exporturl=nexacro._getServiceLocation(_a,this.parent._getFormBaseUrl());}return _a;};_pExcelExport.set_name=function(_a){this.id=this.name=_a;};_pExcelExport.set_exporttype=function(_a){if(_a!=this.exporttype){this.exporttype=_a;var _b=this.excelTypeTable[(_a+"").toUpperCase()];if(!_b){_b=256;}this._exporttype=_b;}return _a;};_pExcelExport.set_activepagename=function(_a){if(_a!=this.activepagename){this.activepagename=_a;}return _a;};_pExcelExport.set_exportactivemode=function(_a){if(_a!=this.exportactivemode){this.exportactivemode=_a;}return _a;};_pExcelExport.set_exporteventtype=function(_a){if(_a!=this.exporteventtype){this.exporteventtype=_a;}return _a;};_pExcelExport.set_exportopenmode=function(_a){if(_a!=this.exportopenmode){this.exportopenmode=_a;}return _a;};_pExcelExport.set_exportfilename=function(_a){if(_a!=this.exportfilename){this.exportfilename=_a;}return _a;};_pExcelExport.set_exportmessagealert=function(_a){if(_a!=this.exportmessagealert){this.exportmessagealert=_a;}return _a;};_pExcelExport.set_exportuitype=function(_a){if(_a!=this.exportuitype){this.exportuitype=_a;switch(_a){case "exportprogress":this._exportuitype=1;break;case "statusbar":this._exportuitype=2;break;default:this._exportuitype=0;break;}}return _a;};_pExcelExport.set_exportmessageready=function(_a){if(_a!=this.exportmessageready){this.exportmessageready=_a;}return _a;};_pExcelExport.set_exportmessageprocess=function(_a){if(_a!=this.exportmessageprocess){this.exportmessageprocess=_a;}return _a;};_pExcelExport.set_exportmessagecomplete=function(_a){if(_a!=this.exportmessagecomplete){this.exportmessagecomplete=_a;}return _a;};_pExcelExport.set_filedialogpath=function(_a){this.filedialogpath=_a;};_pExcelExport.set_openedpath=function(_a){};_pExcelExport.set_filefilter=function(_a){this.filefilter=_a;};_pExcelExport.set_filefilterindex=function(_a){this.filefilterindex=_a;};_pExcelExport.addExportItem=function(_a,_b,_c){var _d= -1;var _e;if(arguments.length==2){if(_a&&_b&&_b instanceof nexacro.ExportItem){_e=_b;_e.parent=this;_e._setEventHandler("onprogress",this.on_notify_onprogress,this);_e._setEventHandler("onsuccess",this.on_notify_onsuccess,this);_e._setEventHandler("onerror",this.on_notify_onerror,this);}else{return  -1;}}else{if(_a&&_b&&_a==this._getItemType(_b)){_e=new nexacro.ExportItem(this.id+"item"+this._uniqueIndex++ ,this);_e._setEventHandler("onprogress",this.on_notify_onprogress,this);_e._setEventHandler("onsuccess",this.on_notify_onsuccess,this);_e._setEventHandler("onerror",this.on_notify_onerror,this);var _f=arguments.length;switch(_f){case 11:arguments[10]&&_e.set_acceptstyle(arguments[10]);case 10:arguments[9]&&_e.set_exportsize(arguments[9]);case 9:arguments[8]&&_e["set_exceptstyle"](arguments[8]);case 8:arguments[7]&&_e["set_exportimage"](arguments[7]);case 7:arguments[6]&&_e["set_exportvalue"](arguments[6]);case 6:arguments[5]&&_e["set_exportmerge"](arguments[5]);case 5:arguments[4]&&_e["set_exportselect"](arguments[4]);case 4:arguments[3]&&_e["set_exporthead"](arguments[3]);case 3:arguments[2]&&_e["set_range"](arguments[2]);case 2:arguments[1]&&_e["set_source"](arguments[1]);break;}}else{return  -1;}}switch(_a){case nexacro.ExportItemTypes.GRID:_e.set_type(_a);_d=this._grids.push(_e)-1;break;case nexacro.ExportItemTypes.DATA:break;case nexacro.ExportItemTypes.XML:break;}return _d;};_pExcelExport.clear=function(){var _a=0;_a+=this._grids.length;_a+=this._dataset.length;_a+=this._xml.length;this._grids=[];this._dataset=[];this._xml=[];return _a;};_pExcelExport.clearExportItems=function(_a){var _b;switch(_a){case nexacro.ExportItemTypes.GRID:_b=this._grids.length;this._grids.length=0;this._grids=[];break;}if(_b==0){this._uniqueIndex=0;}return _b;};_pExcelExport.count=function(){var _a=0;_a+=this._grids.length;_a+=this._dataset.length;_a+=this._xml.length;return _a;};_pExcelExport.countExportItems=function(_a){var _b=0;switch(_a){case nexacro.ExportItemTypes.GRID:_b+=this._grids.length;break;}return _b;};_pExcelExport.delExportItem=function(_a,_b){var _c=false;switch(_a){case nexacro.ExportItemTypes.GRID:if(this._grids.splice(_b,1).length>0){_c=true;}break;}return _c;};_pExcelExport.getExportItem=function(_a,_b){var _c=null;switch(_a){case nexacro.ExportItemTypes.GRID:_c=this._grids[_b];break;}return _c?_c:null;};_pExcelExport.setExportItem=function(_a,_b,_c){if(!_c||!(_c instanceof nexacro.ExportItem)){return false;}var _d=false;switch(_a){case nexacro.ExportItemTypes.GRID:if(_b> -1&&_b<this._grids.length){_c.parent=this;this._grids[_b]=_c;_d=true;}break;}return _d;};_pExcelExport.exportItems=function(_a){var _b= -1;if(!this.exporturl){return _b;}switch(_a){case nexacro.ExportItemTypes.GRID:var _c=this._grids;var _b=this._gCount=_c.length;this._allCount=_b;if(_b>0){if(this.exportmessagealert!=""){alert(this.exportmessagealert);}_c[0]._gridItemExport(this);}break;}return _b;};_pExcelExport._partition_size=100000;_pExcelExport.exportData=function(_a,_b,_c){this._argsParam=_a;this._argsDsParam=_b;this._is_orgval=_c?true:false;if(_a){this._file_password=null;var _d=_a.split(",");for(var _i=_d.length-1,_j=0;_i>=_j;_i-- ){var _e=_d[_i].split("=");if(_e[0]=="filepassword"){this._file_password=_e[1];_d.splice(_i,1);}else if(_e[0]=="wraptext"){this._wrap_text=nexacro._toBoolean(_e[1]);_d.splice(_i,1);}}_a=_d.join(",");this._argsParam=_a;}var _f= -1;if(!this.exporturl){return _f;}var _g=this._grids;var _h=this._gCount=_g.length;this._allCount=_h;if(this._allCount>0&&this.exportmessagealert!=""){alert(this.exportmessagealert);}var _i;for(_i=0;_i<_h;_i++ ){this._allRowCount+=_g[_i].source._getGridRowCount();}if(_h>0){_g[0]._gridItemExport(this);}return this.count();};_pExcelExport.destroy=function(){if(this._exportBar){this._exportBar.destroy();this._exportBar=null;}this._excel_suppress_info=null;this._merge_datas=null;this._grids.length=0;this._dataset.length=0;this._xml.length=0;this.parent.removeChild(this.id);this.parent=null;return true;};_pExcelExport.on_fire_onprogress=function(_a,_b){var _c=this.onprogress;if(_c&&_c._has_handlers){_c._fireEvent(this,_b);}};_pExcelExport.on_fire_onsuccess=function(_a,_b){var _c=this.onsuccess;if(_c&&_c._has_handlers){_c._fireEvent(this,_b);}};_pExcelExport.on_fire_onerror=function(_a,_b){var _c=this.onerror;var _d;if(_c&&_c._has_handlers){_d=_c._fireEvent(this,_b);}return _d;};_pExcelExport.on_notify_onprogress=function(_a,_b){this.on_fire_onprogress(_a,_b);return false;};_pExcelExport.on_notify_onsuccess=function(_a,_b){this.on_fire_onsuccess(_a,_b);return false;};_pExcelExport.on_notify_onerror=function(_a,_b){this.on_fire_onerror(_a,_b);return false;};_pExcelExport.on_complete_download=function(_a,_b,_c,_d,_e,_f){if(_a<0){}else{if(this.exportactivemode=="active"){nexacro._execShell(_b);}}};_pExcelExport._getItemType=function(_a){var _b;switch(_a&&_a._type_name){case "Grid":_b=nexacro.ExportItemTypes.GRID;break;case "Dataset":break;case "Xml":break;}return _b;};_pExcelExport._getProcessStr=function(_a,_b,_c){var _d="";_d=this.exportmessageprocess.replace("%d",_a);_d=_d.replace("%d",_b);_d=_d.replace("%d",_c);return _d;};_pExcelExport._getForm=function(){if(this.parent instanceof nexacro.Form){return this.parent;}return null;};_pExcelExport._getExportBar=function(_a){var _b=this._getForm();var _c="_exportBar";var _d=_b[_c];if(_d){_d.destroy();}_d=new nexacro.ExportProgress(_c,"absolute",0,0,10,10,null,null,_b);_b.addChild(_d.name,_d);_d._uitype=_a;if(_d.createComponent(true)){_d.on_created();}return _d;};delete _pExcelExport;nexacro.ExportItem=function(_a,_b){this.id=this.name=_a;this.parent=_b||null;this.acceptstyle="";this.exceptstyle="";this.exporthead="allband";this._exporthead="";this.exportimage="none";this.exportmerge="suppress";this._exportmerge=1;this.exportselect="allrecord";this.exportvalue="allstyle";this.exportsize="width";this.range="";this.source="";this.type="";this._applyA=true;this._applyB=true;this._applyC=true;this._applyF=true;this._applyHead=true;this._applySumm=true;this._applyL=false;this._d_BLColor="";this._seq=1;this._preStartRow=0;this._startRow=0;this._eof=false;this._instanceId="";this._a_ct=0;this._bg_ct=0;this._c_ct=0;this._f_ct=0;this._l_ct=0;this._t_ct=0;this._sm_ct=0;this._g_ct=0;this._s_ct=0;this._stylecache={};this._selectcount=0;this._merge_datas=null;this._excel_suppress_info={};this._gridTempInfo=null;this._tmpSuppressInfos;this._event_list={"onsuccess":1,"onprogress":1,"onerror":1};};var _pItem=nexacro.ExportItem.prototype=nexacro._createPrototype(nexacro.EventSinkObject,nexacro.ExportItem);_pItem._type_name="ExportItem";_pItem._suppress_align_table={"first":"top","first,over":"top","middle":"middle","middle,over":"middle","last":"bottom","last,over":"bottom"};_pItem.set_acceptstyle=function(_a){if(_a!=this.acceptstyle){this.acceptstyle=_a;switch(_a.toLowerCase()){case "cellline":this._applyL=true;break;}}return _a;};_pItem.set_exceptstyle=function(_a){if(_a!=this.exceptstyle){this.exceptstyle=_a;var _b=_a.replace(/ /g,"").split(",");var _c=_b.length;for(var _d=0;_d<_c;_d++ ){switch(_b[_d].toLowerCase()){case "align":this._applyA=false;break;case "background":this._applyB=false;break;case "color":this._applyC=false;break;case "font":this._applyF=false;break;}}}return _a;};_pItem.set_exporthead=function(_a){if(_a!=this.exporthead){this.exporthead=_a;var _b=_a.replace(/ /g,"").split(",");var _c=_b.length;for(var _d=0;_d<_c;_d++ ){switch(_b[_d].toLowerCase()){case "nohead":this._applyHead=false;break;case "nosumm":this._applySumm=false;break;default:this._applySumm=true;this._applySumm=true;break;}}}if(!this._applyHead||!this._applySumm){if(!this._applyHead&&!this._applySumm){this._exporthead="nohead, nosumm";}else if(!this._applyHead){this._exporthead="nohead";}else{this._exporthead="nosumm";}}else{this._exporthead="allband";}return _a;};_pItem.set_exportimage=function(_a){if(_a!=this.exportimage){this.exportimage=_a;}return _a;};_pItem.set_exportmerge=function(_a){if(_a!=this.exportmerge){this.exportmerge=_a;switch(_a){case "nosuppress":this._exportmerge=0;break;case "merge":this._exportmerge=2;break;default:this._exportmerge=1;break;}}return _a;};_pItem.set_exportselect=function(_a){if(_a!=this.exportselect){this.exportselect=_a;}return _a;};_pItem.set_exportvalue=function(_a){if(_a!=this.exportvalue){this.exportvalue=_a;}return _a;};_pItem.set_range=function(_a){if(_a!=this.range){this.range=_a;}return _a;};_pItem.set_source=function(_a){if(_a!=this.source){this.source=_a;}return _a;};_pItem.set_type=function(_a){if(_a!=this.type){this.type=_a;}return _a;};_pItem.set_exportsize=function(_a){if(_a!=this.exportsize){this.exportsize=_a;}return _a;};_pItem.on_fire_onprogress=function(_a,_b,_c,_d){var _e=this.parent.onprogress;if(_e&&_e._has_handlers){var _f=new nexacro.ExcelExportProgressEventInfo(_a,"onprogress",_b,_c,_d,this);_e._fireEvent(this,_f);}};_pItem.on_fire_onsuccess=function(_a,_b,_c){var _d=this.parent.onsuccess;if(_d&&_d._has_handlers){var _e=new nexacro.ExcelExportEventInfo(_a,"onsuccess",_c,this);_d._fireEvent(this,_e);}};_pItem.on_fire_onerror=function(_a,_b,_c,_d){var _e=this.parent.onerror;if(_e&&_e._has_handlers){var _f=new nexacro.ExcelExportErrorEventInfo(_a,"onerror",_b,_c,this,_d);_e._fireEvent(this,_f);}};_pItem._getWindow=function(){var _a=this.parent.parent;if(_a._is_form){return _a._getWindow();}return null;};_pItem._getWindowHandle=function(){var _a=this.parent.parent;if(_a._is_form){return _a._getWindowHandle();}return null;};_pItem._getCellStyle=function(_a,_b,_c,_d,_e){var _f;var _g=_e=="selected"?true:false;switch(_d){case "align":_f=_a._query_pseudo_align(_b,_a.displaytype,_e);break;case "background":_f=_a._query_pseudo_background(_b,_c,_g,_e);break;case "border":_f=_a._query_pseudo_border(_b,false,"normal",0);break;case "color":_f=_a._query_pseudo_color(_b,_c,_g,_e);break;case "font":_f=_a._query_pseudo_font(_b,_g,_e);break;case "gradation":_f=_a._query_pseudo_gradation(_b,_c,_g,_e);break;}return _f;};_pItem._getCellText=function(_a,_b,_c){var _d;if(_a&&_a instanceof nexacro.Grid){var _e;if(_b== -1){_e="head";}else if(_b== -2){_e="summ";}else{_e="body";}var _f=this.parent;var _g=_a.getCellProperty(_e,_c,"displaytype");if(_a.getSubCellCount(_e,_c)){if(_f._is_orgval&&_g!="date"){_d=_a.getSubCellValue(_b,_c,0);}else{_d=_a.getSubCellText(_b,_c,0);}}else{if(_f._is_orgval&&_g!="date"){_d=_a.getCellValue(_b,_c);}else{_d=_a.getCellText(_b,_c);}}}return _d;};_pItem._find_styleName=function(_a,_b,_c,_d,_e){var _f="";var _g="";var _h=0;var _i= -1;if(_c){_i=_a.findRow("value",_c,_e);if(_i> -1){_g=_a.getColumn(_i,0);if(_g==_b){_f=_a.getColumn(_i,1);}else{return this._find_styleName(_a,_b,_c,_d,_i+1);}}else{_h=_a.getRowCount();_f=_b+ ++_d;_a.addRow();_a.setColumn(_h,"type",_b);_a.setColumn(_h,"name",_f);_a.setColumn(_h,"value",_c);}}return [_f,_d];};_pItem._getFitValue=function(_a){if(!_a){return;}var _b=[];var _c=_a._value;_b=_c.split(" ");return _b.join(",");};_pItem._getFitFontValue=function(_a){if(!_a){return;}var _b,_c=_a.type.split(" ").join(",");_b=_c+","+_a.size+","+_a.face;return _b;};_pItem._getHEXtoRGB=function(_a){var _b;if(typeof _a=="object"){_b=this._getHexColor(_a._value.split(" ")[0]);}else{_b=this._getHexColor(_a);}var _c=[];if(_b===""){_b=_a._value;}else{if(_b.indexOf("#")> -1){_c.push(parseInt(_b.substring(1,3),16));_c.push(parseInt(_b.substring(3,5),16));_c.push(parseInt(_b.substring(5,7),16));_b=_c.join(",");}else{var _d=_b.indexOf("(");var _e=_b.indexOf(")");_c=_b.substring(_d+1,_e-1).split(",");_c.pop();_b=_c.join(",");}}return _b;};_pItem._makeforDsStyle=function(_a,_b,_c,_d,_e,_f,_g,_h,_i){var _j;var _k="";if(this._applyA){_j=this._find_styleName(_a,"align",_b,this._a_ct);style_name=_j[0];this._a_ct=_j[1];_k+="align:"+style_name+",";}if(this._applyB){_j=this._find_styleName(_a,"background",_c,this._bg_ct);style_name=_j[0];this._bg_ct=_j[1];_k+="background:"+style_name+",";}if(this._applyC){_j=this._find_styleName(_a,"color",_d,this._c_ct);style_name=_j[0];this._c_ct=_j[1];_k+="color:"+style_name+",";}if(this._applyF){_j=this._find_styleName(_a,"font",_e,this._f_ct);style_name=_j[0];this._f_ct=_j[1];_k+="font:"+style_name+",";}_j=this._find_styleName(_a,"line",_f,this._l_ct);style_name=_j[0];this._l_ct=_j[1];_k+="line:"+style_name+",";_j=this._find_styleName(_a,"type",_g,this._t_ct);style_name=_j[0];this._t_ct=_j[1];_k+="type:"+style_name;if(_h>1){_j=this._find_styleName(_a,"rowsuppress",_h,this._sm_ct);style_name=_j[0];this._sm_ct=_j[1];_k+=",rowsuppress:"+style_name;}if(_i>1){_j=this._find_styleName(_a,"colsuppress",_i,this._sm_ct);style_name=_j[0];this._sm_ct=_j[1];_k+=",colsuppress:"+style_name;}_j=this._find_styleName(_a,"style",_k,this._s_ct);style_name=_j[0];this._s_ct=_j[1];return style_name;};_pItem._checkExpr=function(_a){if(_a&&_a._bindtype!=0){return true;}return false;};_pItem._checkGradation=function(_a){if(_a._value.match(/@gradation/)){return true;}return false;};_pItem._getHexColor=function(_a){var _b=nexacro._xreNamedColorList[_a];if(_b){return _b;}len=_a.length;if(_a.substring(0,1)=='#'){if(len==7){return _a;}if(len==9){return _a.substr(0,7);}}if(_a.substring(0,2)=="0x"){if(len==8){return "#"+_a.substring(2);}if(len==10){return "#"+_a.substring(2,8);}}return "";};_pItem._getGradationColor=function(_a){var _b;var _c;var _d=[];if(_a){_b=_a._value;if(_b!=""){_b=this._getHexColor(_a.start_color);_c=this._getHexColor(_a.end_color);if(_b.indexOf("#")> -1){var _e=_b+_c;if(this._stylecache[_e]){return this._stylecache[_e];}else{_d.push(Math.round((parseInt(_b.substring(1,3),16)+parseInt(_c.substring(1,3),16))/2));_d.push(Math.round((parseInt(_b.substring(3,5),16)+parseInt(_c.substring(3,5),16))/2));_d.push(Math.round((parseInt(_b.substring(5),16)+parseInt(_c.substring(5),16))/2));_b=_d.join(",");this._stylecache[_e]=_b;}}return _b;}}return "";};_pItem._getCellBodyStyle=function(_a,_b,_c){var _d,_e,_f,_g,_h,_i,_j,_k,_l,_m,_n,_o,_p;var _q="";var _r=this._ds_style;var _s=false;var _t=_a.displaytype._value;_d=_a._stylecache["alignnormal"+_t];_e=_a._stylecache["backgroundfalsefalsenormal"];_g=_a._stylecache["colorfalsefalsenormal"];_i=_a._stylecache["fontfalsenormal"];if(this._applyL){_j=_a._stylecache["linefalsebothn"];if(!_j){_j=_a.style.line;if(!_j){_j=_a._query_pseudo_border(0,false,"normal",0);}}}_f=_a._stylecache["backgroundtruefalsenormal"];_h=_a._stylecache["colortruefalsenormal"];if(!_d&&!_e&&!_g&&!_i){_f=_a.style.background2;if(!_f){_f=_a._query_pseudo_background(0,true,false,"normal");}_h=_a.style.color2;if(!_h){_h=_a._query_pseudo_color(0,true,false,"normal");}}if(!_d){_d=_a.style.align;if(!_d){_d=_a._query_pseudo_align(0,_t,"normal");}}if(!_e){_e=_a.style.background;if(!_e){_e=_a._query_pseudo_background(0,false,false,"normal");}}if(!_g){_g=_a.style.color;if(!_g){_g=_a._query_pseudo_color(0,false,false,"normal");}}if(!_i){_i=_a.style.font;if(!_i){_i=_a._query_pseudo_font(0,false,"normal");}}var _u=_d?_d._getStyleObject(this.source._isRtl()):null;_u=this._getFitValue(_u);if(this._checkGradation(_e)){_k=_a._stylecache["gradationfalsefalsenormal"];if(!_k){_k=_a.style.gradation;if(!_k){_k=_a._query_pseudo_gradation(0,false,false,"normal");}}var _v=this._getGradationColor(_k);}else{var _v=this._getHEXtoRGB(_e);}var _w=this._getHEXtoRGB(_g);var _x=this._getFitFontValue(_i);var _y="empty:empty:empty:empty";var _z={vertical:"empty",horizon:"empty"};if(this._applyL&&_j){if(_j.right_style!="none"&&_j._right_width!=0){_z.vertical=this._getHEXtoRGB(_j.right_color)+(_j.right_style=="solid"?"":","+_j.right_style);_z.horizon=this._getHEXtoRGB(_j.bottom_color)+(_j.bottom_style=="solid"?"":","+_j.bottom_style);if(this._applyHead){_y=(_a._col==0?_z.vertical:"empty")+":"+"empty"+":";}else{_y=(_a._col==0?_z.vertical:"empty")+":"+(_a._row==0?_z.horizon:"empty")+":";}_y+=_z.vertical+":"+_z.horizon;}}if(this._checkExpr(_d)){_u=undefined;}else{this._stylecache[_b+"align"]=_u;}if(this._checkExpr(_e)){_v=undefined;}else{this._stylecache[_b+"background0"]=_v;}if(this._checkExpr(_g)){_w=undefined;}else{this._stylecache[_b+"color0"]=_w;}if(this._checkExpr(_i)){_x=undefined;}else{this._stylecache[_b+"font"]=_x;}if(this._checkExpr(_j)){_line=undefined;}else{this._stylecache[_b+"line"]=_y;}if(_f){if(this._checkGradation(_f)){_l=_a._stylecache["gradationtruefalsenormal"];if(!_l){_l=_a.style.gradation2;if(!_l){_l=_a._query_pseudo_gradation(0,true,false,"normal");}}var _o=this._getGradationColor(_l);}else{var _o=this._getHEXtoRGB(_f);}if(this._checkExpr(_f)){_o=undefined;}else{this._stylecache[_b+"background1"]=_o;}if(_v!=_o){_s=true;}}else{this._stylecache[_b+"background1"]=_o=_v;}if(_h){var _p=this._getHEXtoRGB(_h);if(this._checkExpr(_h)){_p=undefined;}else{this._stylecache[_b+"color1"]=_p;}if(_w!=_p){_s=true;}}else{this._stylecache[_b+"color1"]=_p=_w;}var _aa=this._getFixedCellType(_a,0);_m=this._makeforDsStyle(_r,_u,_v,_w,_x,_y,_aa);if(_s){_n=this._makeforDsStyle(_r,_u,_o,_p,_x,_y,_aa);}subCell=_a._subcells;subL=subCell.length;if(subL){var _ab="";for(var _ac=0;_ac<subL;_ac++ ){_ab+=this._modifyFormat(subCell[_ac],_m,_n,0,_a);}return _ab;}else{return this._modifyFormat(_a,_m,_n,0,undefined,undefined,_c);}};_pItem._getFixedCellType=function(_a,_b){var _c=_a._getDisplaytype(_b);var _d="";switch(_c){case "number":var _e=_a._getAttrValue(_a.mask,_b);if(_e!=null&&_e.length!=0){_d=_e;}break;case "date":case "time":case "datetime":_c="date";var _e=_a._getAttrValue(_a.mask,_b);if(_e==null||_e.length==0||!_e.match(/LONGDATE|SHORTDATE|[yMdHhms]/)){_e="yyyy-MM-dd";}else{var _f=_a._getAttrValue(_a.locale,_b);if(!_f){_f=_a.grid._getLocale();}if(_e=="SHORTDATE"){_e=nexacro.Locale._makeDateMaskString(_f,_e);if(_e==""){_e=nexacro.Locale._default_shortdate_format;}}else if(_e=="LONGDATE"){_e=nexacro.Locale._makeDateMaskString(_f,"SHORTDATE");if(_e==""){_e=nexacro.Locale._default_longdate_format;}}}_d=_e;break;case "image":if(this.exportimage.toLowerCase()=="image"){_d+="image";}_c="text";break;case "text":if(_a._getAttrValue(_a.displaytype,_b)=="normal"){_c="normal";}else{_c="text";}break;default:_c="text";break;}return _c+(_d?":"+_d:"");};_pItem._modifyFormat=function(_a,_b,_c,_d,_e,_f,_g){var _h,_i,_j;_i=_j="";var _k=_a._subcells;var _l=_k?_k.length:0;var _m=1;var _n=1;var _o=_a._colspan;var _p=_a._rowspan;var _q=_a._row;var _r=_g!==undefined?_g:_a._col;var _s=_q;var _t=_r;_h=_d<0?_a._getDisplayText(_d):_a.text._value;_h=nexacro._encodeXml(_h);if(_e){_q=_s+_e._row;_r=_t+_e._col;}else{_m=_p;_n=_o;}_j+="<Cell ";_j+="row=\""+_q+"\" col=\""+_r+"\" ";_i+="rowspan=\""+_m+"\" ";_i+="colspan=\""+_n+"\" ";if(this._exportmerge==1){if(_f!=null){_h=_f;}}else if(this._exportmerge==2){if(_f!=null){_i=_f;}}_j+=_i;if(_h){_j+="text=\""+_h+"\" ";}var _u="";var _v=this.source;_j+="style1=\""+_b+"\" ";if(_c){_j+="style2=\""+_c+"\" ";}var _w=_a.displaytype;if(_w){var _x=_w._value;if(_x=="image"&&this.exportimage.toLowerCase()=="image"){_j+="displaytype=\"image\" ";}_u=_a._getDisplaytype(_d);switch(_u){case "image":case "text":_u="string";break;case "number":_u="int";break;case "date":case "time":case "datetime":_u="date";var _y=_a._getAttrValue(_a.mask,_d);if(_y==null||_y.length==0||!_y.match(/[yMdHhms]/)){_y="yyyy-MM-dd";}_j+="displaytype=\""+_y+"\" ";break;default:_u="text";break;}_j+="type=\""+_u+"\" ";}_j+="/>";return _j;};_pItem._getSubCellLine=function(_a,_b,_c,_d,_e){var _f,_g,_h,_i;var _j=_a._col;var _k=_a._row;if(_j==_e){_h=_c.vertical;}else{_h="empty";}if(_j==0){_f=_b.vertical;}else{_f="empty";}if(_k==_d){_i=_c.horizon;}else{_i="empty";}if(_k==0){_g=_b.horizon;}else{_g="empty";}return _f+":"+_g+":"+_h+":"+_i;};_pItem._makeFakeLine=function(_a,_b,_c){var _d;switch(_a){case "topfake":case "bottomfake":_d="empty:empty:"+_b.vertical+":empty";break;case "rightfake":if(_c){_d="empty:empty:empty:"+_b.horizon;}else{_d="empty:"+_b.horizon+":empty:empty";}break;case "righttopfake":case "rightbottomfake":_d="empty:empty:empty:empty";break;default:if(_c){_d="empty:empty:"+_b.vertical+":"+_b.horizon;}else{_d="empty:"+_b.horizon+":"+_b.vertical+":empty";}break;}return _d;};_pItem._makeFormat=function(_a){var _b,_c,_d,_e,_f,_g,_h,_i,_j,_k;var _l=_a._curFormat;var _m=_l._headcells;var _n=_m?_m.length:0;var _o=_l._bodycells;var _p=_o?_o.length:0;var _q=_l._summcells;var _r=_q?_q.length:0;var _s="";var _t=this._ds_style;var _u={vertical:"empty",horizon:"empty"};var _v="empty:empty:empty:empty";var _w=0;var _x=_l._cols;var _y=_l._headrows;var _z=_l._bodyrows;var _aa=_l._summrows;var _ab=_a._isRtl(_a);_s="<Formats><Format><Columns>";if(!_ab){for(var _al=0,_am=_x.length;_al<_am;_al++ ){_s+='<Column size="'+Math.round(_x[_al].size)+'" />';}}else{for(var _am=_x.length,_al=_am-1;_al>=0;_al-- ){_s+='<Column size="'+Math.round(_x[_al].size)+'" />';}}_s+="</Columns><Rows>";for(var _al=0,_an=_y?_y.length:0;_al<_an;_al++ ){_s+='<Row size="'+Math.round(_y[_al].size)+'" band="head" />';}for(var _al=0,_an=_z?_z.length:0;_al<_an;_al++ ){_s+='<Row size="'+Math.round(_z[_al].size)+'" />';}for(var _al=0,_an=_aa?_aa.length:0;_al<_an;_al++ ){_s+='<Row size="'+Math.round(_aa[_al].size)+'" band="summ" />';}_s+="</Rows>";if(_n>0&&this._applyHead){_s+="<Head>";for(var _al=0,_ao=_n-1;_al<_n;_al++ ,_ao-- ){_h=_m[_al];_j=this._getCellStyle(_h, -1,false,"background","normal");if(this._checkGradation(_j)){_k=this._getCellStyle(_h, -1,false,"gradation","normal");_b=this._getGradationColor(_k);}else{_b=this._getHEXtoRGB(_j);}var _ac=this._getCellStyle(_h, -1,false,"align","normal");_ac=_ac?_ac._getStyleObject(_ab):null;_c=this._getFitValue(_ac);_d=this._getFitFontValue(this._getCellStyle(_h, -1,false,"font","normal"));_e=this._getHEXtoRGB(this._getCellStyle(_h, -1,false,"color","normal"));_u={vertical:"empty",horizon:"empty"};if(this._applyL){_f=this._getCellStyle(_h, -1,false,"border","normal");if(_f){if(_f.right_style!="none"&&_f._right_width!=0){_u.vertical=this._getHEXtoRGB(_f.right_color)+(_f.right_style=="solid"?"":","+_f.right_style);}if(_f.bottom_style!="none"&&_f._bottom_width!=0){_u.horizon=this._getHEXtoRGB(_f.bottom_color)+(_f.bottom_style=="solid"?"":","+_f.bottom_style);}}}var _ad=this._getFixedCellType(_h, -1);_i=_h._subcells;_w=_i.length;if(_w){for(var _ap=0;_ap<_w;_ap++ ){_v=this._getSubCellLine(_i[_ap],_u,_u,_h._rowspan-1,_h._colspan-1);_g=this._makeforDsStyle(_t,_c,_b,_e,_d,_v,_ad);_s+=this._modifyFormat(_i[_ap],_g,null, -1,_h);}}else{_v=(_h._col==0?_u.vertical:"empty")+":"+(_h._row==0?_u.horizon:"empty")+":";_v+=_u.vertical+":"+_u.horizon;var _ae=false;var _af=null;var _ag=0;var _ah=0;if(this._exportmerge==1){if(!!_a._checkFakeMerge(_h, -1)){_v=this._makeFakeLine(_h._fakemerge_infos[1],_u,true);_af="";var _ai=this._merge_datas&&this._merge_datas[ -1+"_"+_al];if(_ai){if(_ai.isFakeStart){_af=nexacro._encodeXml(_h._getDisplayText( -1));if(_c!="left,top"){var _aj=_c.split(",");var _ak=_ai[_aj[1]]+"_"+_ai[_aj[0]];if(this._merge_datas[_ak]){this._merge_datas[_ak].disPlayText=_af;this._merge_datas[_ak].showText=true;}else{this._merge_datas[_ak]={disPlayText:_af,showText:true};}}_af="";}else if(_ai.showText){_af=_ai.disPlayText;}}}}else if(this._exportmerge==2){var _ai=this._merge_datas&&this._merge_datas[ -1+"_"+_al];if(_ai){if(_ai.isFakeStart){_af="rowspan=\""+_ai.rowspan+"\" colspan=\""+_ai.colspan+"\" ";}else{_ae=true;}}}if(!_ae){_g=this._makeforDsStyle(_t,_c,_b,_e,_d,_v,_ad);if(!_ab){_s+=this._modifyFormat(_h,_g,null, -1,false,_af);}else{_s+=this._modifyFormat(_h,_g,null, -1,false,_af,_ao);}}}}_s+="</Head>";}if(_p>0){_s+="<Body>";for(var _al=0,_ao=_p-1;_al<_p;_al++ ,_ao-- ){_h=_o[_al];if(!_ab){_s+=this._getCellBodyStyle(_h,_al);}else{_s+=this._getCellBodyStyle(_h,_al,_ao);}}_s+="</Body>";}if(_r>0&&this._applySumm){_s+="<Summary>";for(var _al=0,_ao=_r-1;_al<_r;_al++ ,_ao-- ){_h=_q[_al];_j=this._getCellStyle(_h, -2,false,"background","normal");if(this._checkGradation(_j)){_k=this._getCellStyle(_h, -2,false,"gradation","normal");_b=this._getGradationColor(_k);}else{_b=this._getHEXtoRGB(_j);}var _ac=this._getCellStyle(_h, -2,false,"align","normal");_ac=_ac?_ac._getStyleObject(_ab):null;_c=this._getFitValue(_ac);_d=this._getFitFontValue(this._getCellStyle(_h, -2,false,"font","normal"));_e=this._getHEXtoRGB(this._getCellStyle(_h, -2,false,"color","normal"));_u={vertical:"empty",horizon:"empty"};if(this._applyL){_f=this._getCellStyle(_h, -2,false,"border","normal");if(_f){if(_f.right_style!="none"&&_f._right_width!=0){_u.vertical=this._getHEXtoRGB(_f.right_color)+(_f.right_style=="solid"?"":","+_f.right_style);}if(_f.top_style!="none"&&_f._top_width!=0){_u.horizon=this._getHEXtoRGB(_f.top_color)+(_f.top_style=="solid"?"":","+_f.top_style);}}}var _ad=this._getFixedCellType(_h, -2);_i=_h._subcells;_w=_i.length;if(_w){for(var _ap=0;_ap<_w;_ap++ ){_v=this._getSubCellLine(_i[_ap],_u,_u,_h._rowspan-1,_h._colspan-1);_g=this._makeforDsStyle(_t,_c,_b,_e,_d,_v,_ad);_s+=this._modifyFormat(_i[_ap],_g,null, -2,_h);}}else{var _ae=false;_v=_u.vertical+":"+_u.horizon+":"+_u.vertical+":"+_u.horizon;var _af=null;if(this._exportmerge==1){if(!!_a._checkFakeMerge(_h, -2)){_v=this._makeFakeLine(_h._fakemerge_infos[0],_u);_af="";var _ai=this._merge_datas&&this._merge_datas[ -2+"_"+_al];if(_ai){if(_ai.isFakeStart){_af=nexacro._encodeXml(_h._getDisplayText( -2));if(_c!="left,top"){var _aj=_c.split(",");var _ak=_ai[_aj[1]]+"_"+_ai[_aj[0]];if(this._merge_datas[_ak]){this._merge_datas[_ak].disPlayText=_af;this._merge_datas[_ak].showText=true;}else{this._merge_datas[_ak]={disPlayText:_af,showText:true};}_af="";}}else if(_ai.showText){_af=_ai.disPlayText;}}}}else if(this._exportmerge==2){if(!!_a._checkFakeMerge(_h, -2)){var _ai=this._merge_datas&&this._merge_datas[ -2+"_"+_al];if(_ai){if(_ai.isFakeStart){_af="rowspan=\""+_ai.rowspan+"\" colspan=\""+_ai.colspan+"\" ";}else{_ae=true;}}}}if(!_ae){_g=this._makeforDsStyle(_t,_c,_b,_e,_d,_v,_ad);if(!_ab){_s+=this._modifyFormat(_h,_g,null, -2,false,_af);}else{_s+=this._modifyFormat(_h,_g,null, -2,false,_af,_ao);}}}}_s+="</Summary>";}_s+="</Format></Formats>";return _s;};_pItem._getForm=function(){return this.parent.parent;};_pItem._eventExport=function(_a,_b,_c,_d){var _e=_a.exporteventtype;var _f=_a._itemsIndex;var _g=_a._exportBar;if(_e!="none"){var _h=_c+1;var _i="";var _j=_h==this._bodyRowCnt;var _k=_a._progress_pos+_h;if(_e=="item"&&_j){this.on_fire_onprogress(_a,_f,this.type,_d==null?_c:_d);if(_g){_i=_a._getProcessStr(_f+1,_k,_a._allRowCount);_g._set_text(_i);_g._set_pos((_f+1)/_a._allCount*100);}}else if(_e=="itemrecord"){this.on_fire_onprogress(_a,_f,this.type,_d==null?_c:_d);if(_g){_i=_a._getProcessStr(_f+1,_h,this._bodyRowCnt);_g._set_text(_i);_g._set_pos(_h/this._bodyRowCnt*100);}}else if(_e=="totalrecord"){this.on_fire_onprogress(_a,_f,this.type,_d==null?_c:_d);if(_g){_i=_a._getProcessStr(_f+1,_k,_a._allRowCount);_g._set_text(_i);_g._set_pos(_k/_a._allRowCount*100);}}if(_k==_a._allRowCount&&_a.exportmessagecomplete!=""){if(_g){_g._set_text(_a.exportmessagecomplete);}}if(_j&&_g){_a._progress_pos=_k;}}};_pItem._updateBarPos=function(_a,_b){if(_b!="none"&&_a._exportuitype){var _c=_a._itemsIndex;var _d=_a._exportBar;_a._progress_pos+=this._startRow-this._preStartRow;var _e="";var _f=this._startRow==this._bodyRowCnt;if(_b=="item"&&_f){_e=_a._getProcessStr(_c+1,_a._progress_pos,_a._allRowCount);_d._set_text(_e);_d._set_pos((_c+1)/_a._allCount*100);}else if(_b=="itemrecord"){_e=_a._getProcessStr(_c+1,this._startRow,this._bodyRowCnt);_d._set_text(_e);_d._set_pos(this._startRow/this._bodyRowCnt*100);}else if(_b=="totalrecord"){_e=_a._getProcessStr(_c+1,_a._progress_pos,_a._allRowCount);_d._set_text(_e);_d._set_pos(_a._progress_pos/_a._allRowCount*100);}if(_a._progress_pos==_a._allRowCount&&_a.exportmessagecomplete!=""){_d._set_text(_a.exportmessagecomplete);}}};_pItem._rollbackSuppressInfo=function(){var _a=this.source._curFormat._bodycells;var _b=this._tmpSuppressInfos&&this._tmpSuppressInfos.length;for(var _c=0;_c<_b;_c++ ){_a[_c]._suppress_infos=this._tmpSuppressInfos.shift();}};_pItem._gridSuppressUpdate=function(_a,_b){var _c=_a._curFormat._bodycells;var _d=_c.length;this._tmpSuppressInfos=[];for(var _e=0;_e<_d;_e++ ){this._tmpSuppressInfos.push(_c[_e]._suppress_infos);}_a._analyzeSuppress(true);for(var _e=0;_e<_b;_e++ ){_a._suppressUpdateRow(_e,0,_b-1,true);}};_pItem._gridExportContinue=function(_a){var _b=this.source;var _c=this._ds_command;_c.setColumn(0,"command","export");_c.setColumn(0,"type",_a._exporttype);_c.setColumn(0,"item",_b.id);_c.setColumn(0,"seq",this._seq);_c.setColumn(0,"startrow",this._startRow);_c.setColumn(0,"instanceid",this._instanceId);_c.setColumn(0,"url",_a._fileURL);_c.setColumn(0,"summarytype",_b.summarytype);_c.setColumn(0,"range",this.range);_c.setColumn(0,"exportsize",this.exportsize);_c.setColumn(0,"exporthead",this._exporthead);_c.setColumn(0,"exportimage",this.exportimage);_c.setColumn(0,"exportfilename",_a.exportfilename);_c.setColumn(0,"format","");_c.setColumn(0,"password",_a._file_password);_c.setColumn(0,"wraptext",_a._wrap_text);var _d=this._ds_style;var _e=this._ds_style2;if(!_e){var _e=new Dataset("STYLE2");this._ds_style2=_e;_e.addColumn("type","String",10);_e.addColumn("name","String",32);_e.addColumn("value","String",1024);}else{this._ds_style2.clearData();}delete this._ds_cell;var _f=new Dataset("CELL");this._ds_cell=_f;var _g=_b.getCellCount("body");var _h=this._bodyRowCnt;var _i;var _j;if(this._exportmerge&&_b._is_use_suppress&&_h>=_b._bodyBand._get_rows().length){this._gridSuppressUpdate(_b,_h);}var _k=null;var _l=null;if(_g>0){var _m=0;var _n=0;for(var _bz=0;_bz<_g;_bz++ ){_f.addColumn("Column"+_bz,"String",256);}var _o=this._partitionRow+this._startRow;if(_o>=_h){_o=_h;this._eof=true;_k=this.parent._argsParam;_l=this.parent._argsDsParam;}var _p=_b._curFormat._bodycells;var _q;var _r=0;var _s;for(var _ca=this._startRow;_ca<_o;_ca++ ){_s=0;var _t;var _u=false;for(var _cb=0;_cb<_g;_cb++ ){_u=_u||_b.isSelectedCell(_cb,"body",_ca, -9);}var _v=this.exportselect=="selectrecord";if(_u||!_v){var _w=_f.addRow();if(_v){this._eventExport(_a,this.type,_ca,this._selectcount++ );}else{this._eventExport(_a,this.type,_ca);}}else{continue;}var _x=_ca%2;var _y=0;_q=false;var _z=(this.exportvalue=="selectstyle");for(var _cb=0;_cb<_g;_cb++ ){_q=_b.isSelectedCell(_cb,"body",_ca, -9);if(_q){var _aa=false;}else{if(_v){_aa=true;}}var _ab;var _ac;var _ad;var _ae;var _af;var _ag=_b._bodyBand;var _ah=_p[_cb];var _ai=_ah._suppress_infos;var _aj="";var _ak="normal";var _al=this._stylecache[_cb+"align"];var _am=this._stylecache[_cb+"line"];var _an,_ao,_ap;if(_q&&_z){_ak="selected";_an="";_ao="";_ap="";}else{if(_aa){_an="255,255,255";_ao="255,255,255";var _aq=this._d_BLColor;_am=_aq+":"+_aq+":"+_aq+":"+_aq;_ar=true;}else{_an=this._stylecache[_cb+"background"+_x];_ao=this._stylecache[_cb+"color"+_x];}_ap=this._stylecache[_cb+"font"];}var _ar=false;if(_an){_ab=_an;}else{_ar=true;_ab=nexacro._nvl(this._getHEXtoRGB(this._getCellStyle(_ah,_ca,_x,"background",_ak)),"");}if(_al){_ac=_al;}else{_ar=true;_ac=nexacro._nvl(this._getFitValue(this._getCellStyle(_ah,_ca,_x,"align",_ak)),"");}if(_ao){_ae=_ao;}else{_ar=true;_ae=nexacro._nvl(this._getHEXtoRGB(this._getCellStyle(_ah,_ca,_x,"color",_ak)),"");}if(_ap){_ad=_ap;}else{_ar=true;_ad=nexacro._nvl(this._getFitFontValue(this._getCellStyle(_ah,_ca,_x,"font",_ak)),"");}var _as,_aq,_at,_au,_av;_as=false,_at=null,_au=null;var _aw=0;var _ax=0;switch(this._exportmerge){case 0:break;case 1:if(_ah.suppress>0){_ar=_as=true;if(_ai[_ca].border_proc){_au="empty";}}_b._checkFakeMerge(_ah,_ca);if(_ah._fakemerge_infos){var _ay=_ah._fakemerge_infos[_ca+2];if(_ay){_ar=_as=true;switch(_ay){case "bottomfake":_au="empty";break;case "rightbottomfake":_at=_au="empty";break;case "rightfake":_at="empty";break;}}}break;case 2:if(_ah.suppress>0){_ar=_as=true;var _az=_cb+"count";var _ba=this._excel_suppress_info;if(!_ba[_az]){_ba[_az]=0;_ac=_ac.split(",")[0]+", "+this._suppress_align_table[_ah.suppressalign];}if(_ai[_ca].border_proc){this._excel_suppress_info[_az]++ ;}else{_aw= ++_ba[_az];_ba[_az]=0;}}var _bb=this._merge_datas&&this._merge_datas[_ca+"_"+_cb];if(_bb&&_bb.isFakeEnd){_ar=_as=true;_aw=_bb.rowspan;_ax=_bb.colspan;}break;}if(!_as&&_am){_af=_am;}else{if(this._applyL){_ar=true;var _bc=this._getCellStyle(_ah,_ca,_x,"border",_ak);if(_bc.right_style!="none"&&_bc._right_width!=0){_av=this._getHEXtoRGB(_bc.right_color)+(_bc.right_style=="solid"?"":","+_bc.right_style);if(!_at){_at=_av;}}else{_at="empty";}if(_bc.bottom_style!="none"&&_bc._bottom_width!=0){_av=this._getHEXtoRGB(_bc.bottom_color)+(_bc.bottom_style=="solid"?"":","+_bc.bottom_style);if(!_au){_au=_av;}}else{_au="empty";}}else{_au=_at="empty";}_af="empty:empty:"+_at+":"+_au;}if(this._applyA){_j=this._find_styleName(_d,"align",_ac,this._a_ct);_i=_j[0];if(this._a_ct!=_j[1]){_j=this._find_styleName(_e,"align",_ac,this._a_ct);}this._a_ct=_j[1];_aj+="align:"+_i+",";}if(this._applyB){_j=this._find_styleName(_d,"background",_ab,this._bg_ct);_i=_j[0];if(this._bg_ct!=_j[1]){_j=this._find_styleName(_e,"background",_ab,this._bg_ct);}this._bg_ct=_j[1];_aj+="background:"+_i+",";}if(this._applyC){_j=this._find_styleName(_d,"color",_ae,this._c_ct);_i=_j[0];if(this._c_ct!=_j[1]){_j=this._find_styleName(_e,"color",_ae,this._c_ct);}this._c_ct=_j[1];_aj+="color:"+_i+",";}if(this._applyF){_j=this._find_styleName(_d,"font",_ad,this._f_ct);_i=_j[0];if(this._f_ct!=_j[1]){_j=this._find_styleName(_e,"font",_ad,this._f_ct);}this._f_ct=_j[1];_aj+="font:"+_i+",";}_j=this._find_styleName(_d,"line",_af,this._l_ct);_i=_j[0];if(this._l_ct!=_j[1]){_j=this._find_styleName(_e,"line",_af,this._l_ct);}this._l_ct=_j[1];_aj+="line:"+_i+",";var _bd=this._getFixedCellType(_ah,_ca);_j=this._find_styleName(_d,"type",_bd,this._t_ct);_i=_j[0];if(this._t_ct!=_j[1]){_j=this._find_styleName(_e,"type",_bd,this._t_ct);}this._t_ct=_j[1];_aj+="type:"+_i;var _be=false;if(_bd.indexOf("date")> -1&&(this._checkExpr(_ah.locale)||this._checkExpr(_ah.mask)||_ah.mask=="LONGDATE")){_ar=true;if(_ah.mask=="LONGDATE"){_be=true;}}if(_aw){_j=this._find_styleName(_d,"rowsuppress",_aw,this._sm_ct);_i=_j[0];if(this._sm_ct!=_j[1]){_j=this._find_styleName(_e,"rowsuppress",_aw,this._sm_ct);}this._sm_ct=_j[1];_aj+=",rowsuppress:"+_i;}if(_ax){_j=this._find_styleName(_d,"colsuppress",_ax,this._sm_ct);_i=_j[0];if(this._sm_ct!=_j[1]){_j=this._find_styleName(_e,"colsuppress",_ax,this._sm_ct);}this._sm_ct=_j[1];_aj+=",colsuppress:"+_i;}_j=this._find_styleName(_d,"style",_aj,this._s_ct);_i=_j[0];if(this._s_ct!=_j[1]){_j=this._find_styleName(_e,"style",_aj,this._s_ct);}this._s_ct=_j[1];var _bf=this._getCellText(_b,_ca,_cb);_t=_aa?"":_bf;if(_be){_ah.mask="SHORTDATE";_t=_ah._getDisplayText_date(_ca);_ah.mask="LONGDATE";}var _bg=_b.getCellProperty("body",_cb,"displaytype");if(_bg=="image"){var _bh=this.exportimage.toLowerCase();if(_bh=="url"||_bh=="image"){var _bi=this._getCellText(_b,_ca,_cb);if(_bi){var _bj=nexacro._getURIValue(_bi);_t=nexacro._getImageLocation(_bj,this._getForm()._getFormBaseUrl());}else{_t=_bi;}}else{_t="";}}var _bk=String.fromCharCode(29);if(this._exportmerge==1){if(_ah.suppress>0){if(_ai[_ca].text_proc){_t="";}}if(!!_b._checkFakeMerge(_ah,_ca)){_t="";var _bb=this._merge_datas&&this._merge_datas[_ca+"_"+_cb];if(_bb){if(_bb.isFakeStart){if(_ac=="left,top"){_t=_bf;}else{var _bl=_ac.split(",");var _bm=_bb[_bl[1]]+"_"+_bb[_bl[0]];if(this._merge_datas[_bm]){this._merge_datas[_bm].disPlayText=_bf;this._merge_datas[_bm].showText=true;}else{this._merge_datas[_bm]={disPlayText:_bf,showText:true};}}}else if(_bb.showText){_t=_bb.disPlayText;}}}}if(_a._is_orgval){_t=nexacro._isNumber(_t)?_t:nexacro._isDecimal(_t)?_t:nexacro._nvl(_t,"");}else{_t=nexacro._nvl(_t,"");}_f.setColumn(_w,"Column"+(_cb+_s),_t+_bk+(_ar||(_q&&_z)?_i:""));if(_ah._subcells.length){var _bn=_ah._subcells;var _bo=_bn.length;var _bp=_ah._rowspan-1;var _bq=_ah._colspan-1;var _br="";var _bc=this._getCellStyle(_ah,_ca,_x,"border",_ak);var _aq=this._d_BLColor;if(this._applyL){_av=this._getHEXtoRGB(_bc.right_color)+(_bc.right_style=="solid"?"":","+_bc.right_style);}else{_av=_aq;}var _bs;var _bt;var _bu;var _bv;for(var _cc=0;_cc<_bo;_cc++ ){var _bw=_bn[_cc]._col;var _bx=_bn[_cc]._row;if(_bw==_bq){_bu=_av;}else{_bu="empty";}if(_bw==0){_bs=_aq;}else{_bs="empty";}if(_bx==_bp){_bv=_av;}else{_bv="empty";}if(_bx==0){_bt=_aq;}else{_bt="empty";}_br=_bs+":"+_bt+":"+_bu+":"+_bv;var _bd=this._getFixedCellType(_bn[_cc],0);_i=this._makeforDsStyle(_d,_ac,_ab,_ae,_ad,_br,_bd);if(_cc!=0){_f.addColumn("Column"+(_bz+_s),"String",256);_s++ ;}var _t=_bn[_cc]._getDisplayText(_ca);if(_a._is_orgval){var _by=_bn[_cc]._refobj;if(_by&&_by._getDisplaytype(_ca)=="number"){_t=_by._getValue(_ca);}}_f.setColumn(_w,"Column"+(_cb+_s),_t+_bk+_i);}}}_r++ ;}this._preStartRow=this._startRow;this._startRow=_o;}_c.setColumn(0,"eof",this._eof);if(this._ds_response){delete this._ds_response;}this._ds_response=new Dataset("RESPONSE");this._rollbackSuppressInfo();if(_l!=undefined){this._transaction(this.id,_a._exporturl,"COMMAND=_ds_command STYLE=_ds_style2 CELL=_ds_cell"+" "+_l,"_ds_response=RESPONSE",_k,"_exportCallback",true,_a._commdataformat,_a._commcompress);}else{this._transaction(this.id,_a._exporturl,"COMMAND=_ds_command STYLE=_ds_style2 CELL=_ds_cell","_ds_response=RESPONSE",_k,"_exportCallback",true,_a._commdataformat,_a._commcompress);}this._updateBarPos(_a,_a.exporteventtype);};_pItem._exportCallback=function(_a,_b,_c){var _d=this.source;var _e=this.parent;var _f=_e._exportBar;if(_b<0){_c=nexacro._decodeXml(_c);this.on_fire_onerror(_e,"ObjectError",_c,_b);nexacro._stopTransaction(this,0);if(_f){_f._hide();_f._set_pos(0);_f._set_text("");}if(_d._hasTree&&this._gridTempInfo&&_e._tempSaveMethod){nexacro.Grid.prototype._recreate_contents_all=_e._tempSaveMethod;_e._tempSaveMethod=null;_d.set_treeinitstatus(this._gridTempInfo["treeinitstatus"]);_d._treeIndexes=this._gridTempInfo["treeIndexes"];_d._treeStates=this._gridTempInfo["treeStates"];_d.enableevent=this._gridTempInfo["enableevent"];this._gridTempInfo=null;}}else{var _g=this._ds_response.getColumn(0,"item");this._instanceId=this._ds_response.getColumn(0,"instanceid");var _h=this._ds_response.getColumn(0,"url");if(_h!=null&&_h!=""){_e._fileURL=_h;}var _i=_e._itemsIndex;var _j=_i+1==_e._allCount;var _k=this._startRow==this._bodyRowCnt;this._seq++ ;if(_k){if(_d._hasTree&&this._gridTempInfo&&_e._tempSaveMethod){nexacro.Grid.prototype._recreate_contents_all=_e._tempSaveMethod;_e._tempSaveMethod=null;_d.set_treeinitstatus(this._gridTempInfo["treeinitstatus"]);_d._treeIndexes=this._gridTempInfo["treeIndexes"];_d._treeStates=this._gridTempInfo["treeStates"];_d.enableevent=this._gridTempInfo["enableevent"];this._gridTempInfo=null;}if(_j){if(_f){_f._hide();_f._set_pos(0);_f._set_text("");}this._tmpSuppressInfos=null;_e._fileURL="";_e._allRowCount=0;_e._progress_pos=0;_e._itemsIndex=0;this.on_fire_onsuccess(_e,this,_h);var _l;switch(_e.exporttype){case nexacro.ExportTypes.EXCEL:case nexacro.ExportTypes.EXCEL97:_l=_e.exportfilename;_l+=".xls";break;case nexacro.ExportTypes.EXCEL2007:_l=_e.exportfilename;_l+=".xlsx";break;case nexacro.ExportTypes.HANCELL2010:case nexacro.ExportTypes.HANCELL2014:_l=_e.exportfilename;_l+=".cell";break;case nexacro.ExportTypes.CSV:_l=_e.exportfilename;_l+=".csv";break;}var _m=new RegExp("[\:\@\&\=\+\$\#\,]","g");if(_m.test(_e.exportfilename)){var _n=_h.split(_l);var _o=encodeURIComponent(_l);if(_n.length<=1){_o=encodeURIComponent(_e.exportfilename);_n=_h.split(_o);if(nexacro.Browser=="IE"){_o=encodeURI(_o);}}var _p="";for(var _s=0,_t=_n.length;_s<_t;_s++ ){_p+=_n[_s];if(_s==0){_p+=_o;}}if(_h!=_p){_h=_p;}_p=null;_n=null;_o=null;}else{_h=encodeURI(_h);}var _q=nexacro._download(_h,_e._handle,_l,"undefined",_e.exportactivemode,this.parent.filedialogpath,_e.filefilter,_e.filefilterindex);if(_q!=undefined){var _r=_q.lastIndexOf("\\");if(_r>0){this.parent.openedpath=_q.substring(0,_r+1);}}}else{_e._itemsIndex++ ;if(_e._itemsIndex==_e._gCount){}else{_e._grids[_e._itemsIndex]._gridItemExport(_e);}}this._instanceId="";this._startRow=0;this._seq=1;this._eof=false;this._selectcount=0;}else{this._gridExportContinue(_e);}}};_pItem._makeMergeDatas=function(_a,_b,_c){var _d=_b;var _e=this._merge_datas={};var _f,_g,_h,_i;var _j,_k,_l,_m,_n,_o;_l=_k=_m=_n=_o=0;var _p,_q,_r,_s,_t,_u,_v,_w,_x,_y,_z;var _aa=_a._getGridRowCount()-1;for(var _ab=0,_ac=_a._fake_mergecell_arr.length;_ab<_ac;_ab++ ){_j=_a._fake_mergecell_arr[_ab];if(_j.start_subrow!=null){_n=_j.start_subrow;}if(_j.end_subrow!=null){_m=_j.end_subrow;}if(_j.end_row>_aa){_l=_k=_aa;_m=_d-1;}else{_l=_k=_j.end_row;_m=_j.end_subrow;}if(_j.start_row== -1){_d=_a._curFormat._headrows?_a._curFormat._headrows.length:0;_k=_z=0;}else if(_j.start_row== -2){_d=_a._curFormat._summrows?_a._curFormat._summrows.length:0;_k=_z=0;}else{_z=_j.start_row;}_p=(_d*_k+_j.end_subrow)-(_d*_z+_n)+1;_q=_j.end_column-_j.start_column+1;var _o=((_d*_z+_n+1)+(_d*_k+_j.end_subrow+1))/2<<0;_r=_j.start_row;_s=(_o-1)/_d<<0;_t=_l;_x=_c*_n+_j.start_column;_y=_c*_j.end_subrow+_j.end_column;_u=((_o-1)%_d*_c+_j.start_column)<<0;_v=((_o-1)%_d*_c+(_j.start_column+_j.end_column)/2)<<0;_w=((_o-1)%_d*_c+_j.end_column)<<0;if(_j.start_row<0){_s=_j.start_row;}_e[_r+"_"+_x]={isFakeStart:true,left:_u,center:_v,right:_w,top:_r,middle:_s,bottom:_t,rowspan:_p,colspan:_q};_e[_t+"_"+_y]={isFakeEnd:true,rowspan:_p,colspan:_q};}};_pItem._gridItemExport=function(_a){var _b=_a._exportuitype;if(_a.exporteventtype!="none"&&_b){var _c=_a._exportBar;if(!_c||_c._uitype!=_b){_c=_a._exportBar=_a._getExportBar(_b);var _d=_a._getProcessStr(_a.count(),_a._allRowCount,_a._allRowCount);_d=nexacro._getLongerStr(_d,_a.exportmessagecomplete,_a.exportmessageready);var _e=nexacro._getTextSize(_d,_c.currentstyle.font);_c._textWidth=_e[0];_c._textHeight=_e[1];}if(_a._itemsIndex==0&&_a.exportmessageready!=""){_c._set_text(_a.exportmessageready);}_c._show();}var _f=this.source;var _g=_f._curFormat._cols?_f._curFormat._cols.length:0;var _h=_f._curFormat._bodyrows?_f._curFormat._bodyrows.length:0;if(_f._hasTree){this._gridTempInfo={};_a._tempSaveMethod=nexacro.Grid.prototype._recreate_contents_all;nexacro.Grid.prototype._recreate_contents_all=nexacro._emptyFn;this._gridTempInfo["enableevent"]=_f.enableevent;_f.enableevent=false;this._gridTempInfo["treeIndexes"]=_f._treeIndexes.slice(0);this._gridTempInfo["treeStates"]=_f._treeStates.slice(0);this._gridTempInfo["treeinitstatus"]=_f.treeinitstatus;_f.set_treeinitstatus("expand,all");}if(_f._is_use_fakemerge){this._makeMergeDatas(_f,_h,_g);}var _i=new Dataset("STYLE");this._ds_style=_i;_i.addColumn("type","String",10);_i.addColumn("name","String",32);_i.addColumn("value","String",1024);var _j=new Dataset("COMMAND");this._ds_command=_j;_j.addColumn("command","String",32);_j.addColumn("type","int",32);_j.addColumn("item","String",256);_j.addColumn("seq","int");_j.addColumn("startrow","int",32);_j.addColumn("eof","boolean",32);_j.addColumn("instanceid","String",256);_j.addColumn("url","String",256);_j.addColumn("summarytype","String",256);_j.addColumn("range","String",32);_j.addColumn("exportsize","String",32);_j.addColumn("exporthead","String",32);_j.addColumn("exportimage","String",32);_j.addColumn("exportfilename","String",32);_j.addColumn("format","String",1024*1024);_j.addColumn("password","String",256);_j.addColumn("wraptext","boolean",32);_j.addRow();_j.setColumn(0,"command","export");_j.setColumn(0,"type",_a._exporttype);_j.setColumn(0,"item",_f.id);_j.setColumn(0,"seq",this._seq);_j.setColumn(0,"startrow",this._startRow);_j.setColumn(0,"instanceid",this._instanceId);_j.setColumn(0,"url",_a._fileURL);_j.setColumn(0,"summarytype",_f.summarytype);_j.setColumn(0,"range",this.range);var _k=this.exportselect=="selectrecord";var _l=_f.selecttype!=("area"||"multiarea"||"treecell")?true:false;if(_l){if(_k){if(this._exporthead==""){this._exporthead="nohead, nosumm";this._applyHead=false;this._applySumm=false;}this._exportmerge=false;}}else{this._exporthead="nohead, nosumm";this._applyHead=false;this._applySumm=false;}_j.setColumn(0,"exportsize",this.exportsize);_j.setColumn(0,"exporthead",this._exporthead);_j.setColumn(0,"exportimage",this.exportimage);_j.setColumn(0,"exportfilename",_a.exportfilename);var _m=nexacro._replaceAll(this._makeFormat(_f),"&#13;","");_j.setColumn(0,"format",_m);_j.setColumn(0,"password",_a._file_password);_j.setColumn(0,"wraptext",_a._wrap_text);var _n=new Dataset("CELL");this._ds_cell=_n;var _o=_f.getCellCount("body");var _p=this._bodyRowCnt=_f._getGridRowCount();var _q;var _r;if(this._exportmerge&&_f._is_use_suppress&&_p>=_f._bodyBand._get_rows().length){this._gridSuppressUpdate(_f,_p);}var _s=null;var _t=null;if(_o>0){var _u=0;var _v="";var _w=_p/5;for(var _ce=0;_ce<_o;_ce++ ){_n.addColumn("Column"+_ce,"String",256);_v+=this._getCellText(_f,0,_ce);_v+=this._getCellText(_f,_w*2,_ce);_v+=this._getCellText(_f,_w*3,_ce);_v+=this._getCellText(_f,_w*4,_ce);_v+=this._getCellText(_f,_p-1,_ce);}_v=_v.length+1;var _x=this._partitionRow=parseInt(_a._partition_size/_v);if(_x==0&&_v>0){_x=this._partitionRow=1;}if(_x>=_p){_x=_p;this._eof=true;_s=this.parent._argsParam;_t=this.parent._argsDsParam;}else{_x=parseInt(_x/2);}var _y=_f._curFormat._bodycells;var _z=(this.exportvalue=="selectstyle");var _aa;var _ab;for(var _cf=0;_cf<_x;_cf++ ){_ab=0;var _ac;var _ad=false;for(var _cg=0;_cg<_o;_cg++ ){_ad=_ad||_f.isSelectedCell(_cg,"body",_cf, -9);}if(_ad||!_k){var _ae=_n.addRow();if(_k){this._eventExport(_a,this.type,_cf,this._selectcount++ );}else{this._eventExport(_a,this.type,_cf);}}else{continue;}var _af=_cf%2;_aa=false;for(var _cg=0;_cg<_o;_cg++ ){_aa=_f.isSelectedCell(_cg,"body",_cf, -9);if(_aa){var _ag=false;}else{if(_k){_ag=true;}}var _ah,_ai,_aj,_ak,_al;var _am=_f._bodyBand;var _an=_y[_cg];var _ao=_an._suppress_infos;var _q="";var _ap="normal";var _aq=false;var _ar=this._stylecache[_cg+"align"];var _as=this._stylecache[_cg+"line"];var _at,_au,_av;if(_aa&&_z){_ap="selected";_at="";_au="";_av="";}else{if(_ag){_at="255,255,255";_au="255,255,255";var _aw=this._d_BLColor;_as=_aw+":"+_aw+":"+_aw+":"+_aw;_aq=true;}else{_at=this._stylecache[_cg+"background"+_af];_au=this._stylecache[_cg+"color"+_af];}_av=this._stylecache[_cg+"font"];}if(_at){_ah=_at;}else{_aq=true;_ah=nexacro._nvl(this._getHEXtoRGB(this._getCellStyle(_an,_cf,_af,"background",_ap)),"");}if(_ar){_ai=_ar;}else{_aq=true;_ai=nexacro._nvl(this._getFitValue(this._getCellStyle(_an,_cf,_af,"align",_ap)),"");}if(_au){_ak=_au;}else{_aq=true;_ak=nexacro._nvl(this._getHEXtoRGB(this._getCellStyle(_an,_cf,_af,"color",_ap)),"");}if(_av){_aj=_av;}else{_aq=true;_aj=nexacro._nvl(this._getFitFontValue(this._getCellStyle(_an,_cf,_af,"font",_ap)),"");}var _ax,_aw,_ay,_az,_ba;_ax=false,_ay=null,_az=null;var _bb=0;var _bc=0;switch(this._exportmerge){case 0:break;case 1:if(_an.suppress>0){_aq=_ax=true;if(_ao[_cf].border_proc){_az="empty";}}_f._checkFakeMerge(_an,_cf);if(_an._fakemerge_infos){var _bd=_an._fakemerge_infos[_cf+2];if(_bd){_aq=_ax=true;switch(_bd){case "bottomfake":_az="empty";break;case "rightbottomfake":_ay=_az="empty";break;case "rightfake":_ay="empty";break;}}}break;case 2:if(_an.suppress>0){_aq=_ax=true;var _be=_cg+"count";var _bf=this._excel_suppress_info;if(!_bf[_be]){_bf[_be]=0;_ai=_ai.split(",")[0]+", "+this._suppress_align_table[_an.suppressalign];}if(_ao[_cf].border_proc){this._excel_suppress_info[_be]++ ;}else{_bb= ++_bf[_be];_bf[_be]=0;}}var _bg=this._merge_datas&&this._merge_datas[_cf+"_"+_cg];if(_bg&&_bg.isFakeEnd){_aq=_ax=true;_bb=_bg.rowspan;_bc=_bg.colspan;}break;}if(!_ax&&_as){_al=_as;}else{if(this._applyL){_aq=true;var _bh=this._getCellStyle(_an,_cf,_af,"border",_ap);if(_bh.right_style!="none"&&_bh._right_width!=0){_ba=this._getHEXtoRGB(_bh.right_color)+(_bh.right_style=="solid"?"":","+_bh.right_style);if(!_ay){_ay=_ba;}}else{_ay="empty";}if(_bh.bottom_style!="none"&&_bh._bottom_width!=0){_ba=this._getHEXtoRGB(_bh.bottom_color)+(_bh.bottom_style=="solid"?"":","+_bh.bottom_style);if(!_az){_az=_ba;}}else{_az="empty";}}else{_az=_ay="empty";}_al="empty:empty:"+_ay+":"+_az;}var _bi=this._getFixedCellType(_an,_cf);_q=this._makeforDsStyle(_i,_ai,_ah,_ak,_aj,_al,_bi,_bb,_bc);var _bj=false;if((_bi.indexOf("date")> -1||_bi.indexOf("number")> -1)&&(this._checkExpr(_an.locale)||this._checkExpr(_an.mask)||_an.mask=="LONGDATE")){_aq=true;if(_an.mask=="LONGDATE"){_bj=true;}}var _bk=this._getCellText(_f,_cf,_cg);_ac=_ag?"":_bk;if(_bj){_an.mask="SHORTDATE";_ac=_an._getDisplayText_date(_cf);_an.mask="LONGDATE";}var _bl=_f.getCellProperty("body",_cg,"displaytype");if(_bl=="image"){var _bm=this.exportimage.toLowerCase();if(_bm=="url"||_bm=="image"){var _bn=this._getCellText(_f,_cf,_cg);if(_bn){var _bo=nexacro._getURIValue(_bn);_ac=nexacro._getImageLocation(_bo,this._getForm()._getFormBaseUrl());}else{_ac=_bn;}}else{_ac="";}}var _bp=String.fromCharCode(29);if(this._exportmerge==1){if(_an.suppress>0){if(_ao[_cf].text_proc){_ac="";}}if(!!_f._checkFakeMerge(_an,_cf)){_ac="";var _bg=this._merge_datas&&this._merge_datas[_cf+"_"+_cg];if(_bg){if(_bg.isFakeStart){if(_ai=="left,top"){_ac=_bk;}else{var _bq=_ai.split(",");var _br=_bg[_bq[1]]+"_"+_bg[_bq[0]];if(this._merge_datas[_br]){this._merge_datas[_br].disPlayText=_bk;this._merge_datas[_br].showText=true;}else{this._merge_datas[_br]={disPlayText:_bk,showText:true};}}}else if(_bg.showText){_ac=_bg.disPlayText;}}}}if(_a._is_orgval){_ac=nexacro._isNumber(_ac)?_ac:nexacro._isDecimal(_ac)?_ac:nexacro._nvl(_ac,"");}else{_ac=nexacro._nvl(_ac,"");}_n.setColumn(_ae,"Column"+(_cg+_ab),_ac+_bp+(_aq||(_aa&&_z)?_q:""));if(_an._subcells.length){var _bs=_an._subcells;var _bt=_bs.length;var _bu=_an._rowspan-1;var _bv=_an._colspan-1;var _bw="";var _bh=this._getCellStyle(_an,_cf,_af,"border",_ap);var _aw=this._d_BLColor;if(this._applyL){_ba=this._getHEXtoRGB(_bh.right_color)+(_bh.right_style=="solid"?"":","+_bh.right_style);}else{_ba=_aw;}var _bx;var _by;var _bz;var _ca;for(var _ch=0;_ch<_bt;_ch++ ){var _cb=_bs[_ch]._col;var _cc=_bs[_ch]._row;if(_cb==_bv){_bz=_ba;}else{_bz="empty";}if(_cb==0){_bx=_aw;}else{_bx="empty";}if(_cc==_bu){_ca=_ba;}else{_ca="empty";}if(_cc==0){_by=_aw;}else{_by="empty";}_bw=_bx+":"+_by+":"+_bz+":"+_ca;var _bi=this._getFixedCellType(_bs[_ch],0);_q=this._makeforDsStyle(_i,_ai,_ah,_ak,_aj,_bw,_bi);if(_ch!=0){_n.addColumn("Column"+(_ce+_ab),"String",256);_ab++ ;}var _ac=_bs[_ch]._getDisplayText(_cf);if(_a._is_orgval){var _cd=_bs[_ch]._refobj;if(_cd&&_cd._getDisplaytype(_cf)=="number"){_ac=_cd._getValue(_cf);}}_n.setColumn(_ae,"Column"+(_cg+_ab),_ac+_bp+_q);}}}}this._preStartRow=this._startRow;this._startRow=_x;}else{this._eof=true;_s=this.parent._argsParam;_t=this.parent._argsDsParam;}_j.setColumn(0,"eof",this._eof);if(this._ds_response){delete this._ds_response;}this._ds_response=new Dataset("RESPONSE");this._rollbackSuppressInfo();if(_t!=undefined){this._transaction(this.id,_a._exporturl,"COMMAND=_ds_command STYLE=_ds_style CELL=_ds_cell"+" "+_t,"_ds_response=RESPONSE",_s,"_exportCallback",true,_a._commdataformat,_a._commcompress);}else{this._transaction(this.id,_a._exporturl,"COMMAND=_ds_command STYLE=_ds_style CELL=_ds_cell","_ds_response=RESPONSE",_s,"_exportCallback",true,_a._commdataformat,_a._commcompress);}return true;};_pItem._transaction=function(_a,_b,_c,_d,_e,_f,_g,_h,_i){this._load_manager=new nexacro.LoadManager(this);var _j=nexacro._getServiceObject(_b,true);this._load_manager.loadDataModule(_b,_a,_c,_d,_e,_f,_g,_h,_i,_j);};_pItem._stopTransaction=function(){nexacro.Form.prototype._stopTransaction.apply(this,arguments);};_pItem._getDatasetObject=function(_a){var _b=this[_a];var _c=this.parent.parent;if(_b==null&&_c){_b=_c._getDatasetObject(_a);}if(_b==null){_b=application[_a];}return _b;};_pItem._waitCursor=nexacro._emptyFn;_pItem._removeUrl=function(_a){if(_a&&_a.length){var _b=_a.indexOf("'");var _c= -1;if(_b> -1){_c=_a.lastIndexOf("'");_a=_a.substring(_b+1,_c);}_b=_a.indexOf("(");if(_b> -1){_c=_a.lastIndexOf(")");_a=_a.substring(_b+1,_c);}}return _a;};delete _pItem;nexacro.ExportProgress=function(_a,_b,_c,_d,_e,_f,_g,_h,_i){nexacro.PopupComponent.call(this,_a,_b,_c,_d,_e,_f,_g,_h,_i);this._uitype=0;this.visible=false;this.progressbar=null;};var _pExportProgress=nexacro.ExportProgress.prototype=nexacro._createPrototype(nexacro.PopupComponent,nexacro.ExportProgress);_pExportProgress._type_name="ExportProgress";_pExportProgress.on_apply_style_color=nexacro._emptyFn;_pExportProgress.on_apply_style_font=nexacro._emptyFn;_pExportProgress.on_apply_style_align=nexacro._emptyFn;_pExportProgress.on_create_contents=function(){var _a=this.getElement();if(_a){switch(this._uitype){case 1:this.progressbar=new nexacro.ProgressBarCtrl("progressbar","absolute",0,0,1,1,null,null,this);this.progressbar.createComponent();this.progressbar._setRtlDirection(this._rtldirection);break;case 2:this.progressbar=application.mainframe.statusbar;break;}}};_pExportProgress.on_created_contents=function(){switch(this._uitype){case 1:if(this.progressbar){this.progressbar.on_created();}case 2:break;}};_pExportProgress.on_change_containerRect=function(_a,_b){switch(this._uitype){case 1:this.progressbar.move(null,null,_a,20,0,0);case 2:break;}};_pExportProgress.on_destroy_contents=function(){switch(this._uitype){case 1:this.progressbar.destroy();case 2:this.progressbar=null;break;}};_pExportProgress.set_visible=function(_a){if(this.visible!=_a){this.visible=_a;var _b=this._control_element;_b.setElementVisible(_a);if(this.visible){var _c=this._getResultPseudo(this._status,this._pseudo);this._updateControl(_b,_c);this._updateContents(_b,_c);}if(this.visible){nexacro._resetVML(this);}}};_pExportProgress._getWindow=function(){return nexacro.Component.prototype._getWindow.call(this);};_pExportProgress.on_fire_onlbuttondown=function(_a,_b,_c,_d,_e,_f,_g,_h,_i,_j,_k,_l){return true;};_pExportProgress._on_keydown=function(_a,_b,_c,_d,_e){if(_b==nexacro.Event.KEY_TAB){_a._event_stop=true;}else if(_b==nexacro.Event.KEY_ESC){nexacro._stopTransaction(this,2);}return true;};_pExportProgress._show=function(){if(!this._is_created||!this.parent){return;}var _a=this._getWindow();if(_a){var _b,_c,_d,_e;_b=_a.getLeft();_c=_a.getTop();if(_a.frame){var _f=_a.frame;_d=_f.getOffsetWidth();_e=_f.getOffsetHeight();}else{_d=_a.getClientWidth();_e=_a.getClientHeight();}var _g=_a._getCaptureComp(true,true,this);if(_g!=this){_a._setCaptureLock(this,true,true);}var _h=this.currentstyle.padding;var _i=0;var _j=0;var _k=0;var _l=0;if(this._uitype==1){_i=(this._textWidth<100?100:this._textWidth)+_h.left+_h.right;_j=this._textHeight+_h.top+_h.bottom+22;_k=Math.round((_d-_i)/2);_l=Math.round((_e-_j)/2);}this._adjustPosition(_k,_l,null,null,_i,_j);this.on_update_position(true,true);var _m=this._control_element;if(_m){_m.setElementPosition(_k,_l);_m.setElementSize(_i,_j);this._updateClientSize(_m);}this.set_visible(true);}};_pExportProgress._hide=function(){var _a=this.parent._getWindow();if(_a){_a._releaseCaptureLock(this);if(nexacro._resize_popup_inbound==true){var _b=this._control_element;if(_b){_b.setElementSize(1,1);this._updateClientSize(_b);}}}if(this._is_created&&this._is_alive){this.set_visible(false);}};nexacro._getLongerStr=function(_a,_b,_c){var _d=arguments.length;if(_d<2){return;}var _e=arguments[0];for(var _f=1;_f<_d;_f++ ){if(_e.length<arguments[_f].length){_e=arguments[_f];}}return _e;};_pExportProgress._set_text=function(_a){switch(this._uitype){case 1:this.progressbar.set_text(_a);break;case 2:var _b=this._getForm();_b.set_statustext(_a);break;}};_pExportProgress._set_pos=function(_a){switch(this._uitype){case 1:this.progressbar.set_pos(_a);break;case 2:var _b=this;while(_b&&!_b._is_top_frame){if(_b._is_frame){_b.statusbar&&_b.statusbar.progressbar.set_pos(_a);}_b=_b.parent;}break;}};delete _pExportProgress;}